# Opentrons Bio-Art Simulator

[![Python 3.9+](https://img.shields.io/badge/python-3.9%2B-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![HTGAA 2026](https://img.shields.io/badge/HTGAA-2026-purple.svg)](https://htgaa.org)

**Run and visualize Opentrons OT-2 bio-art protocols locally â€” no robot required.**

Simulate protocols generated by the [Opentrons Art Designer](https://opentrons-art.rcdonovan.com/) or custom HTGAA protocols. Preview your fluorescent protein artwork on a virtual Petri dish before using real hardware.

---

## Features

- **Full mock** of the Opentrons Python API (`ProtocolContext`, pipette, labware, modules)
- **Automatic color mapping** for 30+ fluorescent proteins (sfGFP â†’ lime, mRFP1 â†’ red, etc.)
- **Matplotlib visualization** of the Petri dish with droplets and smears
- **Save images** directly from the command line
- **Volume tracking** â€” detects waste and cross-contamination
- **Zero dependencies** beyond `opentrons` and `matplotlib`

---

## Installation

### From source (recommended)

```bash
git clone https://github.com/Mozta/opentrons-bioart-sim.git
cd opentrons-bioart-sim
python -m venv venv
source venv/bin/activate    # macOS/Linux
pip install -e .
```

### Dependencies only

```bash
pip install opentrons matplotlib
```

---

## Usage

### Option 1 â€” CLI (command line)

```bash
# Run an example protocol
opentrons-bioart-sim examples/octocat.py

# Change the Petri dish background
opentrons-bioart-sim examples/octocat.py --background agar

# Save to file without displaying
opentrons-bioart-sim examples/OTDesign_02-23-26_11-56-55.py --save output.png --no-show

# See all options
opentrons-bioart-sim --help
```

### Option 2 â€” One-liner in Python

```python
from opentrons_bioart_sim import simulate_protocol

mock = simulate_protocol('examples/octocat.py', background='black')
```

### Option 3 â€” Manual control

```python
from opentrons_bioart_sim import OpentronsMock

well_colors = {
    'A1': 'sfGFP',
    'A2': 'mRFP1',
    'A3': 'Azurite',
    # ...
}

mock = OpentronsMock(well_colors)
run(mock)                          # your run(protocol) function
mock.visualize(save_path='art.png')  # render the Petri dish
```

---

## Petri Dish Backgrounds

| Value     | Description                      |
| --------- | -------------------------------- |
| `'black'` | Dark agar plate (default)        |
| `'agar'`  | Normal agar plate (beige)        |
| `'paper'` | Paper insert (outline only)      |

---

## Supported Fluorescent Proteins

| Protein     | Visual Color      | Protein       | Visual Color      |
| ----------- | ----------------- | ------------- | ----------------- |
| sfGFP       | lime              | mRFP1         | red               |
| mCherry     | firebrick         | mKO2          | orange            |
| Venus       | yellow            | Azurite       | royalblue         |
| mTurquoise2 | turquoise         | TagBFP        | blue              |
| mClover3    | green             | mWasabi       | lightgreen        |
| mNeonGreen  | greenyellow       | mScarlet_I    | tomato            |
| mPlum       | purple            | Electra2      | deepskyblue       |
| mJuniper    | darkgreen         | EGFP          | lime              |

> **30+ proteins supported** â€” see [`colors.py`](src/opentrons_bioart_sim/colors.py) for the full list.

---

## Project Structure

```
opentrons-bioart-sim/
â”œâ”€â”€ src/opentrons_bioart_sim/    # Installable package
â”‚   â”œâ”€â”€ __init__.py              #   Public API exports
â”‚   â”œâ”€â”€ cli.py                   #   Command-line interface
â”‚   â”œâ”€â”€ colors.py                #   Protein â†’ color mapping
â”‚   â”œâ”€â”€ mock.py                  #   Mock Opentrons API classes
â”‚   â””â”€â”€ visualization.py         #   Petri dish rendering
â”œâ”€â”€ examples/                    # Example protocols
â”‚   â”œâ”€â”€ octocat.py
â”‚   â”œâ”€â”€ siempre_tuyo.py
â”‚   â”œâ”€â”€ OTDesign_02-23-26_11-56-55.py
â”‚   â””â”€â”€ OTDesign_02-23-26_18-57-12.py
â”œâ”€â”€ notebooks/                   # Original HTGAA Colab notebooks
â”œâ”€â”€ tests/                       # Test suite
â”œâ”€â”€ pyproject.toml               # Build configuration
â”œâ”€â”€ README.md
â”œâ”€â”€ CONTRIBUTING.md
â””â”€â”€ LICENSE
```

---

## Architecture

| Class              | Simulates                  | Key Responsibility |
| ------------------ | -------------------------- | ------------------- |
| `OpentronsMock`    | `ProtocolContext`          | Entry point â€” loads labware, modules, pipettes |
| `PipetteSim`       | `InstrumentContext`        | Tracks droplets, smears, volumes, colors |
| `LabwareMock`      | `Labware`                  | Well plates, tip racks, custom plates |
| `WellMock`         | `Well`                     | Individual well positions and colors |
| `ModuleMock`       | Hardware modules           | Temperature, thermocycler modules |

---

## Development

```bash
# Install with dev dependencies
pip install -e ".[dev]"

# Run tests
pytest tests/ -v

# Lint
ruff check src/ tests/
```

See [CONTRIBUTING.md](CONTRIBUTING.md) for more details.

---

## Credits

- **Original HTGAA Colab Notebook** â€” by **Eyal Perry**, **Laura Maria Gonzalez**, **Dominika Wawrzyniak**, **Alex Hadik**, **Suvin Sundararajan**, and **Ronan Donovan**. Their notebook served as the foundation codebase for this project.
- **MarÃ­a JosÃ© Rivas Arreola** â€” whose HTGAA coursework inspired the creation of this standalone tool for the community.
- **[HTGAA](https://htgaa.org)** â€” How To Grow (Almost) Anything course
- **[Opentrons Art Designer](https://opentrons-art.rcdonovan.com/)** by RC Donovan â€” web tool for designing bio-art protocols
- **[Opentrons](https://opentrons.com/)** â€” open-source lab robotics

---

## License

MIT â€” see [LICENSE](LICENSE) for details.

---

<p align="center">
  Made with ðŸ§¬ + ðŸŽ¨ by <a href="https://github.com/Mozta">Rafael PÃ©rez Aguirre (@Mozta)</a>
</p>
